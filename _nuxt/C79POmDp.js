import{_ as ne}from"./DjnXNV40.js";import{_ as ce}from"./DXJ5giLj.js";import le from"./DBThNqmy.js";import{_ as re}from"./B4-u-BIW.js";import{_ as ie}from"./Dth0woYn.js";import{_ as ue,aH as de,aI as pe,u as me,g as _e,C as he,r as M,i as ve,h as fe,o as r,c as i,b as y,a as e,j as w,k as s,d as k,w as ye,q as h,F as D,l as Q,v as ge,t as m,s as be,m as xe,aL as g,aE as ke,n as Ce,p as Ne,e as Pe,x as T}from"./CPOyUOu7.js";import{t as Me}from"./4yc1bQ4b.js";import"./DlZmmtGM.js";const p=C=>(Ne("data-v-9f1d8bbe"),C=C(),Pe(),C),we={class:"website-body"},De={class:"container"},Re={class:"row page-align",delay:200,initial:{opacity:0,y:100},visible:{opacity:1,y:0}},Se=p(()=>e("h1",{class:"sectitle",style:{"padding-bottom":"2rem"}},"Produtos no carrinho:",-1)),Te={class:"col-md-6"},Be={key:0,class:"nohaveproduct-container"},Ve={class:"hyper-color"},Ie={key:0},Le={class:"item-props"},$e={class:"remove-item"},Ee=p(()=>e("span",null,"por apenas",-1)),Fe={class:"price-line-through"},He={key:1},Ae={class:"col-md-4"},Ue={class:"checkout"},ze=p(()=>e("h1",null,"Resumo do Pedido",-1)),je={class:"coupon-form"},We=p(()=>e("label",null,"Você tem um cupom de desconto?",-1)),qe={style:{display:"flex","align-items":"center"}},Ke=["disabled"],Oe={class:"checkout-informations"},Qe={class:"checkout-value"},Ge=p(()=>e("p",null,"Quantidade de itens no carrinho:",-1)),Je={class:"checkout-value"},Xe=p(()=>e("p",null,"Desconto aplicado:",-1)),Ye={key:0,class:"checkout-value"},Ze={key:0},eo={key:1},oo=p(()=>e("p",null,"Método de Pagamento:",-1)),to={class:"input-group"},so={class:"input-item"},ao=["disabled"],no=p(()=>e("option",{selected:"",value:null}," Selecionar método ",-1)),co=["value"],lo=p(()=>e("hr",null,null,-1)),ro={class:"checkout-informations"},io={class:"checkbox"},uo=p(()=>e("span",null,[k(" Você concorda com os nossos "),e("p",{onclick:"window.open('/terms')"}," Termos?")],-1)),po=p(()=>e("hr",null,null,-1)),mo={class:"checkout-informations"},_o={class:"checkout-value"},ho=p(()=>e("p",null,"Subtotal:",-1)),vo=["disabled"],fo={__name:"cart",setup(C){const G=de(),J=pe(G);me({title:"Meu carrinho",meta:[{name:"description",content:"Visualize o seu carrinho de compras"}]});const b=_e(),X=he(),d=M(!0),c=M([]),t=M({total:0,priceDescount:0,couponName:null,oldCouponName:null,methods:[{label:"MercadoPago",value:"mercadopago",rate:"4.99%",hidden:!0},{label:"Pix",value:"pix",rate:"Sem Taxa",hidden:!0},{label:"Paypal",value:"paypal",rate:"8% + R$0,10",hidden:!0}],currentMethod:null,acceptTerms:!1}),v=M(null),N=async()=>{d.value=!0;const o=await b.$axios.listProductsCart();Y(o),P(o),c.value=o,d.value=!1},Y=o=>{const a=g.filter(o,f=>f.methods.mercadopago),l=g.filter(o,f=>f.methods.paypal),_=g.filter(o,f=>f.methods.mercadopago),[u,x,S]=t.value.methods;a.length===o.length&&(u.hidden=!1),l.length===o.length&&(S.hidden=!1),_.length===o.length&&(x.hidden=!1)},Z=o=>{for(let l of c.value)l.product.setDiscoutPercentage(o),l.product.setPriceFormated();const a=g.filter(c.value,l=>l.product.props.priceDiscountNumber).reduce((l,_)=>l+_.product.props.priceDiscountNumber,0);t.value.priceDescount=a,P(T(c.value))},P=o=>{const a=o.reduce((l,_)=>l+_.product.props.price,0);t.value.total=a},ee=(o,a)=>{const l=g.filter(c.value,u=>a.includes(u._id));for(let u of l)u.product.setDiscountProduct(o),u.product.setPriceFormated();const _=g.filter(c.value,u=>u.product.props.priceDiscountNumber).reduce((u,x)=>u+x.product.props.priceDiscountNumber,0);t.value.priceDescount=_,P(T(c.value))},oe=async()=>{d.value=!0;const o=await b.$axios.customer.validateCoupon(t.value.couponName);if(t.value.couponName.length&&t.value.oldCouponName!==t.value.couponName&&await N(),typeof o=="string"){Me(b,o),t.value.couponName=null,t.value.oldCouponName=null,R();return}t.value.oldCouponName=o.props.name,o.props.isExclusiveHuman==="Não"?Z(o.props.valueCoupon.value):o.props.isExclusiveHuman==="Sim"&&ee(o.props.valueCoupon.value,o.props.productsId),R(),d.value=!1},te=async o=>{d.value=!0;const a=await b.$axios.customer.createPayment(o,t.value.couponName);d.value=!1,await N(),a.payment&&(window.open(a.payment.url,"_blank"),X.push("/customer")),d.value=!1},se=async o=>{d.value=!0,await b.$axios.customer.removeProductCart(o.id),await N(),d.value=!1},ae=o=>{for(let a of c.value)a.product.setRateByMethod(o);P(T(c.value))},R=()=>{if(!t.value.currentMethod)return;const o=t.value.methods.find(a=>a.value===t.value.currentMethod);o&&(v.value=o,ae(t.value.currentMethod))};return ve(()=>{}),fe(async()=>{await N()}),(o,a)=>{var B,V,I,L,$,E;const l=ne,_=ce,u=le,x=re,S=ie,f=ke("motion");return r(),i("div",null,[y(l),y(_),e("div",we,[e("div",De,[w((r(),i("div",Re,[Se,e("div",Te,[e("div",null,[s(c).length===0?(r(),i("div",Be,[e("h1",Ve,[y(u,{name:"svg-spinners:blocks-shuffle-3"}),k(" Você ainda não tem produtos no carrinho! ")]),e("p",null,[k(" Primeiramente, você precisa abrir a nossa "),y(x,{to:"/store",class:"link hyper-color"},{default:ye(()=>[k("loja")]),_:1}),k(" e adicionar um item ao carrinho. ")])])):h("",!0),s(c).length>=1?(r(!0),i(D,{key:1},Q(s(c),n=>{var F,H,A,U,z,j,W,q,K,O;return r(),i("div",{class:Ce(["cart-item border-props",{"blur-loading":s(d)}])},[n.product?(r(),i("div",Ie,[y(S,{style:{height:"127.516px"},src:((F=n.product)==null?void 0:F.props.image)||"images/image-example.png",loading:"lazy",format:"webp",class:"product-image"},null,8,["src"])])):h("",!0),e("div",Le,[e("div",$e,[e("h1",null,m((A=(H=n.product)==null?void 0:H.props)==null?void 0:A.title),1),y(u,{name:"prime:trash",class:"trash-icon",onClick:yo=>se(n==null?void 0:n.product)},null,8,["onClick"])]),Ee,(U=n.product.props)!=null&&U.priceDiscount?(r(),i(D,{key:0},[e("h2",null,m((z=n.product.props)==null?void 0:z.priceFormated),1),e("span",Fe,m((W=(j=n.product)==null?void 0:j.props)==null?void 0:W.oldPrice),1)],64)):h("",!0),(q=n.product.props)!=null&&q.priceDiscount?h("",!0):(r(),i("h2",He,m((O=(K=n.product)==null?void 0:K.props)==null?void 0:O.priceFormated),1))])],2)}),256)):h("",!0)])]),e("div",Ae,[e("div",Ue,[ze,e("form",je,[We,e("div",qe,[w(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=n=>s(t).couponName=n),placeholder:"Cupom de desconto"},null,512),[[ge,s(t).couponName]]),e("button",{type:"button",disabled:!s(t).couponName||s(t).couponName===s(t).oldCouponName||s(d),onClick:oe}," Aplicar ",8,Ke)])]),e("div",Oe,[e("div",Qe,[Ge,e("span",null,m(s(c).length.toLocaleString("pt-BR")),1)]),e("div",Je,[Xe,e("span",null,"-"+m(s(t).priceDescount.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1)]),(B=s(v))!=null&&B.label?(r(),i("div",Ye,[e("p",null,"Taxa do "+m((V=s(v))==null?void 0:V.label)+" aplicado:",1),s(v).value!="pix"?(r(),i("span",Ze,"+"+m(s(v).rate),1)):h("",!0),s(v).value=="pix"?(r(),i("span",eo,m(s(v).rate),1)):h("",!0)])):h("",!0),e("div",null,[oo,e("form",to,[e("div",so,[w(e("select",{class:"form-select border-props mb-4","aria-label":"select-gateway",disabled:!s(c).length,"onUpdate:modelValue":a[1]||(a[1]=n=>s(t).currentMethod=n),onChange:R},[no,(r(!0),i(D,null,Q(s(t).methods,n=>(r(),i(D,null,[n.hidden?h("",!0):(r(),i("option",{key:0,value:n.value},m(n.label),9,co))],64))),256))],40,ao),[[be,s(t).currentMethod]])])])]),lo]),e("div",ro,[e("div",io,[w(e("input",{type:"checkbox",class:"check","onUpdate:modelValue":a[2]||(a[2]=n=>s(t).acceptTerms=n)},null,512),[[xe,s(t).acceptTerms]]),uo]),po]),e("div",mo,[e("div",_o,[ho,e("span",null,m(s(t).total.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),1)])]),e("button",{type:"button",class:"checkout-btn",disabled:s(d)||!s(t).currentMethod||!s(t).acceptTerms||!((E=($=(L=(I=s(J).user)==null?void 0:I.value)==null?void 0:L.props)==null?void 0:$.discord)!=null&&E.email),onClick:a[3]||(a[3]=n=>te(s(t).currentMethod))}," CHECKOUT ",8,vo)])])])),[[f]])])])])}}},wo=ue(fo,[["__scopeId","data-v-9f1d8bbe"]]);export{wo as default};
